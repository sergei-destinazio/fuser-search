/* Fuser Search */
window.fsAttributes=window.fsAttributes||[],window.fsAttributes.push(["cmsload",s=>{console.log("ready"),window.isFuseListLoaded=!0},]);document.addEventListener("DOMContentLoaded",function(){var e,t;let l=document.querySelector('[data-fuse-element="input"]'),i=document.querySelector('[data-fuse-element="list"]'),a=Array.from(i.querySelectorAll(".w-dyn-item")),n=new Map,s=document.querySelector('[data-fuse-element="clear-button"]'),r=document.querySelector('[data-fuse-element="no-results"]'),o=document.querySelector('[data-fuse-element="initial-element"]'),c=1,d=document.querySelector('[data-fuse-element="pagination"]'),u=d?+d.getAttribute("data-fuse-items-per-page"):10,f=document.querySelector('[data-fuse-element="pagination-page-buttons"]'),h=document.querySelector('[data-fuse-element="prev"]'),m=document.querySelector('[data-fuse-element="next"]'),y=document.querySelector('[data-fuse-element="excerpt-source"]'),p;y&&(p=y.getAttribute("data-fuse-field")),s&&s.addEventListener("click",()=>{l.value="",c=1,A()});let g=[];a.length>0&&a[0].querySelectorAll("[data-fuse-field]").forEach(e=>{g.push(e.getAttribute("data-fuse-field"))}),r&&(r.style.display="none"),o&&(i.style.display="none"),o&&d&&(d.style.display="none"),document.querySelectorAll("[fuse-initial-hidden]").forEach(e=>{e.removeAttribute("fuse-initial-hidden")});let v=S();function S(){return(a=Array.from(i.querySelectorAll(".w-dyn-item"))).map(e=>{let t=e.getAttribute("data-fuse-id"),l={id:t};return g.forEach(t=>{let i=e.querySelector(`[data-fuse-field="${t}"]`),a=i?i.innerText.trim():"";l[t]=a}),n.set(t,e),l})}let L=setInterval(()=>{v=S(),_.setCollection(v),(l.value||d)&&A(),window.isFuseListLoaded&&clearInterval(L),i.querySelectorAll("[data-fuse-item]").forEach(e=>{e.removeAttribute("data-fuse-item")}),console.log(v)},1e3),_=new Fuse(v,{keys:(e=g).map(e=>({name:e,weight:+document.querySelector(`[data-fuse-field="${e}"]`)?.getAttribute("data-fuse-weight")||1})),threshold:.4,distance:100,ignoreLocation:!0,includeMatches:!0,includeScore:!0});function b(e,t){let l=t.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),i=RegExp(`(${l.join("|")})`,"gi");return e.replace(i,"<span data-fuse-highlight>$1</span>")}function $(e,t){let l=e.toLowerCase(),i=-1,a="";for(let n of t){let s=l.indexOf(n.toLowerCase());if(-1!==s){i=s,a=n;break}}if(-1===i&&t.length)for(let r of t){let o=r.slice(0,3),c=RegExp(o,"i"),d=e.match(c);if(d&&void 0!==d.index){i=d.index,a=d[0];break}}let u="";if(-1!==i){let f=Math.max(0,i-40),h=Math.min(e.length,i+40);u=e.slice(f,h),f>0&&(u="..."+u),h<e.length&&(u+="...")}else u=e.slice(0,80),e.length>80&&(u+="...");return b(u,t)}let E="title",q;function A(){let e=l.value.trim();if(a.forEach(t=>{""===e?(t.removeAttribute("style"),t.classList.remove("is-fuse-visible")):(t.style.display="none",t.classList.remove("is-fuse-visible"))}),o&&""===e){i.style.display="none",r&&(r.style.display="none"),o.removeAttribute("style"),d&&(d.style.display="none");return}let t=function e(t){let l=new Set(["a","an","the","is","of","in","at","on","to","for","with","and","or","does","how","what","can","do"]),i=t.trim().toLowerCase().split(/\s+/).filter(e=>e.length>2&&!l.has(e)),a=new Map,n=_.search(t);return n.forEach(e=>{let t=e.item.id;a.set(t,{item:e.item,scoreSum:e.score,count:1,fullMatch:!0,matchedWords:new Set,matchedInTitle:!1})}),i.forEach(e=>{let t=_.search(e);t.forEach(t=>{let l=t.item.id;a.has(l)||a.set(l,{item:t.item,scoreSum:0,count:0,fullMatch:!1,matchedWords:new Set,matchedInTitle:!1});let i=a.get(l);i.scoreSum+=t.score,i.count+=1,i.matchedWords.add(e),g.includes(E)&&t.item[E]?.toLowerCase().includes(e)&&(i.matchedInTitle=!0)})}),Array.from(a.values()).map(e=>({item:e.item,averageScore:e.scoreSum/e.count,fullMatch:e.fullMatch,matchedCount:e.matchedWords.size,matchedInTitle:e.matchedInTitle})).sort((e,t)=>e.matchedInTitle&&!t.matchedInTitle?-1:!e.matchedInTitle&&t.matchedInTitle?1:t.matchedCount!==e.matchedCount?t.matchedCount-e.matchedCount:e.fullMatch&&!t.fullMatch?-1:!e.fullMatch&&t.fullMatch?1:e.averageScore-t.averageScore)}(e),s=e.toLowerCase().split(/\s+/).filter(e=>e.length>2);if(r&&""!==e&&!t.length){i.style.display="none",o&&(o.style.display="none"),r.removeAttribute("style"),d&&(d.style.display="none");return}r&&(r.style.display="none"),o&&(o.style.display="none"),i.removeAttribute("style"),d?t.length?function e(t,l){let s=Math.ceil(t.length/u),r=(c-1)*u,o=t.slice(r,r+u);a.forEach(e=>{e.style.display="none",e.classList.remove("is-fuse-visible")}),d.removeAttribute("style"),o.length&&o.forEach(e=>{let t=n.get(e.item.id);if(t){if(t.style.display="",t.classList.add("is-fuse-visible"),g.forEach(i=>{let a=t.querySelector(`[data-fuse-field="${i}"]`);a&&(a.innerHTML=b(e.item[i],l))}),p){let a=t.querySelector('[data-fuse-element="excerpt-container"]');a&&(a.innerHTML=`<p>${$(e.item[p],l)}</p>`)}i.appendChild(t)}}),w(s)}(t,s):function e(){let t=Math.ceil(v.length/u),l=(c-1)*u,s=v.slice(l,l+u);a.forEach(e=>{e.style.display="none",e.classList.remove("is-fuse-visible")}),d.removeAttribute("style"),s.forEach(e=>{let t=n.get(e.id);if(t){if(t.style.display="",t.classList.add("is-fuse-visible"),i.querySelectorAll("[data-fuse-highlight]").forEach(e=>e.removeAttribute("data-fuse-highlight")),p){let l=t.querySelector('[data-fuse-element="excerpt-container"]');l&&(l.innerHTML="")}i.appendChild(t)}}),w(t)}():e?function e(t,l){t.forEach(e=>{let t=n.get(e.item.id);if(t){if(t.removeAttribute("style"),t.classList.add("is-fuse-visible"),g.forEach(i=>{let a=t.querySelector(`[data-fuse-field="${i}"]`);a&&(a.innerHTML=b(e.item[i],l))}),p){let a=t.querySelector('[data-fuse-element="excerpt-container"]');a&&(a.innerHTML=`<p>${$(e.item[p],l)}</p>`)}i.appendChild(t)}})}(t,s):v.forEach(e=>{let t=n.get(e.id);if(t){if(i.querySelectorAll("[data-fuse-highlight]").forEach(e=>e.removeAttribute("data-fuse-highlight")),p){let l=t.querySelector('[data-fuse-element="excerpt-container"]');l&&(l.innerHTML="")}i.appendChild(t)}})}function C(){let e=document.createElement("div");e.textContent="...",e.classList.add("fuse-page-dots"),f.appendChild(e)}function w(e){if(c===e?m.style.display="none":m.removeAttribute("style"),1===c?h.style.display="none":h.removeAttribute("style"),d){f.innerHTML="";for(let t=1;t<=e;t++){let l=document.createElement("button");l.textContent=t,l.classList.add("fuse-page-button"),t===c&&l.classList.add("is-fuse-current"),l.addEventListener("click",()=>{c=t,A()}),(1===t||t===e||t===c||1===c&&(2===t||3===t)||2===c&&3===t||c===e&&(t===e-1||t===e-2)||c===e-1&&t===e-2)&&f.appendChild(l),(c>2&&1===t||c<e-1&&t===e-1)&&C()}}}l.addEventListener("input",(t=A,function(...e){c=1,clearTimeout(q),q=setTimeout(()=>t.apply(this,e),400)})),h&&m&&(m.addEventListener("click",()=>{c++,A()}),h.addEventListener("click",()=>{c--,A()}))});